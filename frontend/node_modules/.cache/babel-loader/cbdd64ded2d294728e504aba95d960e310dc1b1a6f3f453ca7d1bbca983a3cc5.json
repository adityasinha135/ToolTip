{"ast":null,"code":"import { HTTPResponse as BaseHTTPResponse } from '../api/HTTPResponse.js';\nimport { Deferred } from '../util/Deferred.js';\nimport { ProtocolError } from './Errors.js';\nimport { SecurityDetails } from './SecurityDetails.js';\n/**\n * @internal\n */\nexport class HTTPResponse extends BaseHTTPResponse {\n  #client;\n  #request;\n  #contentPromise = null;\n  #bodyLoadedDeferred = Deferred.create();\n  #remoteAddress;\n  #status;\n  #statusText;\n  #url;\n  #fromDiskCache;\n  #fromServiceWorker;\n  #headers = {};\n  #securityDetails;\n  #timing;\n  constructor(client, request, responsePayload, extraInfo) {\n    super();\n    this.#client = client;\n    this.#request = request;\n    this.#remoteAddress = {\n      ip: responsePayload.remoteIPAddress,\n      port: responsePayload.remotePort\n    };\n    this.#statusText = this.#parseStatusTextFromExtrInfo(extraInfo) || responsePayload.statusText;\n    this.#url = request.url();\n    this.#fromDiskCache = !!responsePayload.fromDiskCache;\n    this.#fromServiceWorker = !!responsePayload.fromServiceWorker;\n    this.#status = extraInfo ? extraInfo.statusCode : responsePayload.status;\n    const headers = extraInfo ? extraInfo.headers : responsePayload.headers;\n    for (const [key, value] of Object.entries(headers)) {\n      this.#headers[key.toLowerCase()] = value;\n    }\n    this.#securityDetails = responsePayload.securityDetails ? new SecurityDetails(responsePayload.securityDetails) : null;\n    this.#timing = responsePayload.timing || null;\n  }\n  #parseStatusTextFromExtrInfo(extraInfo) {\n    if (!extraInfo || !extraInfo.headersText) {\n      return;\n    }\n    const firstLine = extraInfo.headersText.split('\\r', 1)[0];\n    if (!firstLine) {\n      return;\n    }\n    const match = firstLine.match(/[^ ]* [^ ]* (.*)/);\n    if (!match) {\n      return;\n    }\n    const statusText = match[1];\n    if (!statusText) {\n      return;\n    }\n    return statusText;\n  }\n  _resolveBody(err) {\n    if (err) {\n      return this.#bodyLoadedDeferred.resolve(err);\n    }\n    return this.#bodyLoadedDeferred.resolve();\n  }\n  remoteAddress() {\n    return this.#remoteAddress;\n  }\n  url() {\n    return this.#url;\n  }\n  status() {\n    return this.#status;\n  }\n  statusText() {\n    return this.#statusText;\n  }\n  headers() {\n    return this.#headers;\n  }\n  securityDetails() {\n    return this.#securityDetails;\n  }\n  timing() {\n    return this.#timing;\n  }\n  buffer() {\n    if (!this.#contentPromise) {\n      this.#contentPromise = this.#bodyLoadedDeferred.valueOrThrow().then(async error => {\n        if (error) {\n          throw error;\n        }\n        try {\n          const response = await this.#client.send('Network.getResponseBody', {\n            requestId: this.#request._requestId\n          });\n          return Buffer.from(response.body, response.base64Encoded ? 'base64' : 'utf8');\n        } catch (error) {\n          if (error instanceof ProtocolError && error.originalMessage === 'No resource with given identifier found') {\n            throw new ProtocolError('Could not load body for this request. This might happen if the request is a preflight request.');\n          }\n          throw error;\n        }\n      });\n    }\n    return this.#contentPromise;\n  }\n  request() {\n    return this.#request;\n  }\n  fromCache() {\n    return this.#fromDiskCache || this.#request._fromMemoryCache;\n  }\n  fromServiceWorker() {\n    return this.#fromServiceWorker;\n  }\n  frame() {\n    return this.#request.frame();\n  }\n}","map":{"version":3,"names":["HTTPResponse","BaseHTTPResponse","Deferred","ProtocolError","SecurityDetails","client","request","contentPromise","bodyLoadedDeferred","create","remoteAddress","status","statusText","url","fromDiskCache","fromServiceWorker","headers","securityDetails","timing","constructor","responsePayload","extraInfo","ip","remoteIPAddress","port","remotePort","parseStatusTextFromExtrInfo","statusCode","key","value","Object","entries","toLowerCase","#parseStatusTextFromExtrInfo","headersText","firstLine","split","match","_resolveBody","err","resolve","buffer","valueOrThrow","then","error","response","send","requestId","_requestId","Buffer","from","body","base64Encoded","originalMessage","fromCache","_fromMemoryCache","frame"],"sources":["/home/adityasinha/Desktop/React/topdf/node_modules/puppeteer-core/src/common/HTTPResponse.ts"],"sourcesContent":["/**\n * Copyright 2020 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {Protocol} from 'devtools-protocol';\n\nimport {Frame} from '../api/Frame.js';\nimport {\n  HTTPResponse as BaseHTTPResponse,\n  RemoteAddress,\n} from '../api/HTTPResponse.js';\nimport {Deferred} from '../util/Deferred.js';\n\nimport {CDPSession} from './Connection.js';\nimport {ProtocolError} from './Errors.js';\nimport {HTTPRequest} from './HTTPRequest.js';\nimport {SecurityDetails} from './SecurityDetails.js';\n\n/**\n * @internal\n */\nexport class HTTPResponse extends BaseHTTPResponse {\n  #client: CDPSession;\n  #request: HTTPRequest;\n  #contentPromise: Promise<Buffer> | null = null;\n  #bodyLoadedDeferred = Deferred.create<Error | void>();\n  #remoteAddress: RemoteAddress;\n  #status: number;\n  #statusText: string;\n  #url: string;\n  #fromDiskCache: boolean;\n  #fromServiceWorker: boolean;\n  #headers: Record<string, string> = {};\n  #securityDetails: SecurityDetails | null;\n  #timing: Protocol.Network.ResourceTiming | null;\n\n  constructor(\n    client: CDPSession,\n    request: HTTPRequest,\n    responsePayload: Protocol.Network.Response,\n    extraInfo: Protocol.Network.ResponseReceivedExtraInfoEvent | null\n  ) {\n    super();\n    this.#client = client;\n    this.#request = request;\n\n    this.#remoteAddress = {\n      ip: responsePayload.remoteIPAddress,\n      port: responsePayload.remotePort,\n    };\n    this.#statusText =\n      this.#parseStatusTextFromExtrInfo(extraInfo) ||\n      responsePayload.statusText;\n    this.#url = request.url();\n    this.#fromDiskCache = !!responsePayload.fromDiskCache;\n    this.#fromServiceWorker = !!responsePayload.fromServiceWorker;\n\n    this.#status = extraInfo ? extraInfo.statusCode : responsePayload.status;\n    const headers = extraInfo ? extraInfo.headers : responsePayload.headers;\n    for (const [key, value] of Object.entries(headers)) {\n      this.#headers[key.toLowerCase()] = value;\n    }\n\n    this.#securityDetails = responsePayload.securityDetails\n      ? new SecurityDetails(responsePayload.securityDetails)\n      : null;\n    this.#timing = responsePayload.timing || null;\n  }\n\n  #parseStatusTextFromExtrInfo(\n    extraInfo: Protocol.Network.ResponseReceivedExtraInfoEvent | null\n  ): string | undefined {\n    if (!extraInfo || !extraInfo.headersText) {\n      return;\n    }\n    const firstLine = extraInfo.headersText.split('\\r', 1)[0];\n    if (!firstLine) {\n      return;\n    }\n    const match = firstLine.match(/[^ ]* [^ ]* (.*)/);\n    if (!match) {\n      return;\n    }\n    const statusText = match[1];\n    if (!statusText) {\n      return;\n    }\n    return statusText;\n  }\n\n  override _resolveBody(err: Error | null): void {\n    if (err) {\n      return this.#bodyLoadedDeferred.resolve(err);\n    }\n    return this.#bodyLoadedDeferred.resolve();\n  }\n\n  override remoteAddress(): RemoteAddress {\n    return this.#remoteAddress;\n  }\n\n  override url(): string {\n    return this.#url;\n  }\n\n  override status(): number {\n    return this.#status;\n  }\n\n  override statusText(): string {\n    return this.#statusText;\n  }\n\n  override headers(): Record<string, string> {\n    return this.#headers;\n  }\n\n  override securityDetails(): SecurityDetails | null {\n    return this.#securityDetails;\n  }\n\n  override timing(): Protocol.Network.ResourceTiming | null {\n    return this.#timing;\n  }\n\n  override buffer(): Promise<Buffer> {\n    if (!this.#contentPromise) {\n      this.#contentPromise = this.#bodyLoadedDeferred\n        .valueOrThrow()\n        .then(async error => {\n          if (error) {\n            throw error;\n          }\n          try {\n            const response = await this.#client.send(\n              'Network.getResponseBody',\n              {\n                requestId: this.#request._requestId,\n              }\n            );\n            return Buffer.from(\n              response.body,\n              response.base64Encoded ? 'base64' : 'utf8'\n            );\n          } catch (error) {\n            if (\n              error instanceof ProtocolError &&\n              error.originalMessage ===\n                'No resource with given identifier found'\n            ) {\n              throw new ProtocolError(\n                'Could not load body for this request. This might happen if the request is a preflight request.'\n              );\n            }\n\n            throw error;\n          }\n        });\n    }\n    return this.#contentPromise;\n  }\n\n  override request(): HTTPRequest {\n    return this.#request;\n  }\n\n  override fromCache(): boolean {\n    return this.#fromDiskCache || this.#request._fromMemoryCache;\n  }\n\n  override fromServiceWorker(): boolean {\n    return this.#fromServiceWorker;\n  }\n\n  override frame(): Frame | null {\n    return this.#request.frame();\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}