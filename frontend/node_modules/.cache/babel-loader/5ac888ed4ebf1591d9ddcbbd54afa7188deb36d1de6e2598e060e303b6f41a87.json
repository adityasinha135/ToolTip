{"ast":null,"code":"/**\n * Copyright 2023 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { EMPTY, defer, filter, first, from, identity, ignoreElements, retry, throwIfEmpty } from '../../../third_party/rxjs/rxjs.js';\nimport { Locator, RETRY_DELAY } from './locators.js';\n/**\n * @internal\n */\nexport class NodeLocator extends Locator {\n  static create(pageOrFrame, selector) {\n    return new NodeLocator(pageOrFrame, selector).setTimeout('getDefaultTimeout' in pageOrFrame ? pageOrFrame.getDefaultTimeout() : pageOrFrame.page().getDefaultTimeout());\n  }\n  #pageOrFrame;\n  #selector;\n  constructor(pageOrFrame, selector) {\n    super();\n    this.#pageOrFrame = pageOrFrame;\n    this.#selector = selector;\n  }\n  /**\n   * Waits for the element to become visible or hidden. visibility === 'visible'\n   * means that the element has a computed style, the visibility property other\n   * than 'hidden' or 'collapse' and non-empty bounding box. visibility ===\n   * 'hidden' means the opposite of that.\n   */\n  #waitForVisibilityIfNeeded = handle => {\n    if (!this.visibility) {\n      return EMPTY;\n    }\n    return (() => {\n      switch (this.visibility) {\n        case 'hidden':\n          return defer(() => {\n            return from(handle.isHidden());\n          });\n        case 'visible':\n          return defer(() => {\n            return from(handle.isVisible());\n          });\n      }\n    })().pipe(first(identity), retry({\n      delay: RETRY_DELAY\n    }), ignoreElements());\n  };\n  _clone() {\n    return new NodeLocator(this.#pageOrFrame, this.#selector).copyOptions(this);\n  }\n  _wait(options) {\n    const signal = options?.signal;\n    return defer(() => {\n      return from(this.#pageOrFrame.waitForSelector(this.#selector, {\n        visible: false,\n        timeout: this._timeout,\n        signal\n      }));\n    }).pipe(filter(value => {\n      return value !== null;\n    }), throwIfEmpty(), this.operators.conditions([this.#waitForVisibilityIfNeeded], signal));\n  }\n}","map":{"version":3,"names":["EMPTY","defer","filter","first","from","identity","ignoreElements","retry","throwIfEmpty","Locator","RETRY_DELAY","NodeLocator","create","pageOrFrame","selector","setTimeout","getDefaultTimeout","page","constructor","waitForVisibilityIfNeeded","handle","visibility","isHidden","isVisible","pipe","delay","_clone","copyOptions","_wait","options","signal","waitForSelector","visible","timeout","_timeout","value","operators","conditions"],"sources":["/home/adityasinha/Desktop/React/topdf/node_modules/puppeteer-core/src/api/locators/NodeLocator.ts"],"sourcesContent":["/**\n * Copyright 2023 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  EMPTY,\n  Observable,\n  defer,\n  filter,\n  first,\n  from,\n  identity,\n  ignoreElements,\n  retry,\n  throwIfEmpty,\n} from '../../../third_party/rxjs/rxjs.js';\nimport {HandleFor, NodeFor} from '../../common/types.js';\nimport {Frame} from '../Frame.js';\nimport {Page} from '../Page.js';\n\nimport {ActionOptions, Locator, RETRY_DELAY} from './locators.js';\n\n/**\n * @internal\n */\nexport type Action<T, U> = (\n  element: HandleFor<T>,\n  signal?: AbortSignal\n) => Observable<U>;\n\n/**\n * @internal\n */\nexport class NodeLocator<T extends Node> extends Locator<T> {\n  static create<Selector extends string>(\n    pageOrFrame: Page | Frame,\n    selector: Selector\n  ): Locator<NodeFor<Selector>> {\n    return new NodeLocator<NodeFor<Selector>>(pageOrFrame, selector).setTimeout(\n      'getDefaultTimeout' in pageOrFrame\n        ? pageOrFrame.getDefaultTimeout()\n        : pageOrFrame.page().getDefaultTimeout()\n    );\n  }\n\n  #pageOrFrame: Page | Frame;\n  #selector: string;\n\n  private constructor(pageOrFrame: Page | Frame, selector: string) {\n    super();\n\n    this.#pageOrFrame = pageOrFrame;\n    this.#selector = selector;\n  }\n\n  /**\n   * Waits for the element to become visible or hidden. visibility === 'visible'\n   * means that the element has a computed style, the visibility property other\n   * than 'hidden' or 'collapse' and non-empty bounding box. visibility ===\n   * 'hidden' means the opposite of that.\n   */\n  #waitForVisibilityIfNeeded = (handle: HandleFor<T>): Observable<never> => {\n    if (!this.visibility) {\n      return EMPTY;\n    }\n\n    return (() => {\n      switch (this.visibility) {\n        case 'hidden':\n          return defer(() => {\n            return from(handle.isHidden());\n          });\n        case 'visible':\n          return defer(() => {\n            return from(handle.isVisible());\n          });\n      }\n    })().pipe(first(identity), retry({delay: RETRY_DELAY}), ignoreElements());\n  };\n\n  override _clone(): NodeLocator<T> {\n    return new NodeLocator<T>(this.#pageOrFrame, this.#selector).copyOptions(\n      this\n    );\n  }\n\n  override _wait(options?: Readonly<ActionOptions>): Observable<HandleFor<T>> {\n    const signal = options?.signal;\n    return defer(() => {\n      return from(\n        this.#pageOrFrame.waitForSelector(this.#selector, {\n          visible: false,\n          timeout: this._timeout,\n          signal,\n        }) as Promise<HandleFor<T> | null>\n      );\n    }).pipe(\n      filter((value): value is NonNullable<typeof value> => {\n        return value !== null;\n      }),\n      throwIfEmpty(),\n      this.operators.conditions([this.#waitForVisibilityIfNeeded], signal)\n    );\n  }\n}\n"],"mappings":"AAAA;;;;;;;;;;;;;;;AAgBA,SACEA,KAAK,EAELC,KAAK,EACLC,MAAM,EACNC,KAAK,EACLC,IAAI,EACJC,QAAQ,EACRC,cAAc,EACdC,KAAK,EACLC,YAAY,QACP,mCAAmC;AAK1C,SAAuBC,OAAO,EAAEC,WAAW,QAAO,eAAe;AAUjE;;;AAGA,OAAM,MAAOC,WAA4B,SAAQF,OAAU;EACzD,OAAOG,MAAMA,CACXC,WAAyB,EACzBC,QAAkB;IAElB,OAAO,IAAIH,WAAW,CAAoBE,WAAW,EAAEC,QAAQ,CAAC,CAACC,UAAU,CACzE,mBAAmB,IAAIF,WAAW,GAC9BA,WAAW,CAACG,iBAAiB,EAAE,GAC/BH,WAAW,CAACI,IAAI,EAAE,CAACD,iBAAiB,EAAE,CAC3C;EACH;EAEA,CAAAH,WAAY;EACZ,CAAAC,QAAS;EAETI,YAAoBL,WAAyB,EAAEC,QAAgB;IAC7D,KAAK,EAAE;IAEP,IAAI,CAAC,CAAAD,WAAY,GAAGA,WAAW;IAC/B,IAAI,CAAC,CAAAC,QAAS,GAAGA,QAAQ;EAC3B;EAEA;;;;;;EAMA,CAAAK,yBAA0B,GAAIC,MAAoB,IAAuB;IACvE,IAAI,CAAC,IAAI,CAACC,UAAU,EAAE;MACpB,OAAOrB,KAAK;;IAGd,OAAO,CAAC,MAAK;MACX,QAAQ,IAAI,CAACqB,UAAU;QACrB,KAAK,QAAQ;UACX,OAAOpB,KAAK,CAAC,MAAK;YAChB,OAAOG,IAAI,CAACgB,MAAM,CAACE,QAAQ,EAAE,CAAC;UAChC,CAAC,CAAC;QACJ,KAAK,SAAS;UACZ,OAAOrB,KAAK,CAAC,MAAK;YAChB,OAAOG,IAAI,CAACgB,MAAM,CAACG,SAAS,EAAE,CAAC;UACjC,CAAC,CAAC;;IAER,CAAC,EAAC,CAAE,CAACC,IAAI,CAACrB,KAAK,CAACE,QAAQ,CAAC,EAAEE,KAAK,CAAC;MAACkB,KAAK,EAAEf;IAAW,CAAC,CAAC,EAAEJ,cAAc,EAAE,CAAC;EAC3E,CAAC;EAEQoB,MAAMA,CAAA;IACb,OAAO,IAAIf,WAAW,CAAI,IAAI,CAAC,CAAAE,WAAY,EAAE,IAAI,CAAC,CAAAC,QAAS,CAAC,CAACa,WAAW,CACtE,IAAI,CACL;EACH;EAESC,KAAKA,CAACC,OAAiC;IAC9C,MAAMC,MAAM,GAAGD,OAAO,EAAEC,MAAM;IAC9B,OAAO7B,KAAK,CAAC,MAAK;MAChB,OAAOG,IAAI,CACT,IAAI,CAAC,CAAAS,WAAY,CAACkB,eAAe,CAAC,IAAI,CAAC,CAAAjB,QAAS,EAAE;QAChDkB,OAAO,EAAE,KAAK;QACdC,OAAO,EAAE,IAAI,CAACC,QAAQ;QACtBJ;OACD,CAAiC,CACnC;IACH,CAAC,CAAC,CAACN,IAAI,CACLtB,MAAM,CAAEiC,KAAK,IAAwC;MACnD,OAAOA,KAAK,KAAK,IAAI;IACvB,CAAC,CAAC,EACF3B,YAAY,EAAE,EACd,IAAI,CAAC4B,SAAS,CAACC,UAAU,CAAC,CAAC,IAAI,CAAC,CAAAlB,yBAA0B,CAAC,EAAEW,MAAM,CAAC,CACrE;EACH"},"metadata":{},"sourceType":"module","externalDependencies":[]}